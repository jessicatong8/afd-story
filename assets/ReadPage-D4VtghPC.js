const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/DoorUI-PmVYcKt6.js","assets/index-F6e-HDtp.js","assets/index-DWpnJaI2.css","assets/ScratchReveal-oqKWemDj.js","assets/DumplingFillingUI-_Ixfn9J2.js","assets/modifiers.esm-BHxdyQ4y.js","assets/DumplingGivingUI-BybmAMWr.js","assets/LoveLanguagesUI-C2pDM1pv.js","assets/StoryEndPage-DOnnd7Tx.js"])))=>i.map(i=>d[i]);
import{u as W,a as J,r as u,j as t,N as Q,A as k,m as C,_ as n,b as Z}from"./index-F6e-HDtp.js";const B=u.createContext(void 0),ee=({children:e})=>{const r=W(),c=J(),o=parseInt(c.pageNumber??"0",10),l=32,[p,m]=u.useState(!0),[f,E]=u.useState(!0),[x,s]=u.useState(0),i=()=>{p&&o<l&&(s(1),r(`/read/${o+1}`)),o===l&&r("/read/end")},a=()=>{f&&o>0&&(s(-1),r(`/read/${o-1}`))},_=g=>{m(g)},h=g=>{E(g)};return t.jsx(B.Provider,{value:{handleNext:i,handleBack:a,nextIsActive:p,backIsActive:f,currentPage:o,numPages:l,toggleNext:_,toggleBack:h,direction:x},children:e})},P=()=>{const e=u.useContext(B);if(!e)throw new Error("useReadContext must be used within a ReadContextProvider");return e},te="Left",se="Right",ne="Up",ie="Down",w={delta:10,preventScrollOnSwipe:!1,rotationAngle:0,trackMouse:!1,trackTouch:!0,swipeDuration:1/0,touchEventOptions:{passive:!0}},A={first:!0,initial:[0,0],start:0,swiping:!1,xy:[0,0]},V="mousemove",N="mouseup",re="touchend",oe="touchmove",ae="touchstart";function ce(e,r,c,o){return e>r?c>0?se:te:o>0?ie:ne}function M(e,r){if(r===0)return e;const c=Math.PI/180*r,o=e[0]*Math.cos(c)+e[1]*Math.sin(c),l=e[1]*Math.cos(c)-e[0]*Math.sin(c);return[o,l]}function ue(e,r){const c=s=>{const i="touches"in s;i&&s.touches.length>1||e((a,_)=>{_.trackMouse&&!i&&(document.addEventListener(V,o),document.addEventListener(N,m));const{clientX:h,clientY:g}=i?s.touches[0]:s,d=M([h,g],_.rotationAngle);return _.onTouchStartOrOnMouseDown&&_.onTouchStartOrOnMouseDown({event:s}),Object.assign(Object.assign(Object.assign({},a),A),{initial:d.slice(),xy:d,start:s.timeStamp||0})})},o=s=>{e((i,a)=>{const _="touches"in s;if(_&&s.touches.length>1)return i;if(s.timeStamp-i.start>a.swipeDuration)return i.swiping?Object.assign(Object.assign({},i),{swiping:!1}):i;const{clientX:h,clientY:g}=_?s.touches[0]:s,[d,O]=M([h,g],a.rotationAngle),v=d-i.xy[0],j=O-i.xy[1],T=Math.abs(v),b=Math.abs(j),R=(s.timeStamp||0)-i.start,q=Math.sqrt(T*T+b*b)/(R||1),K=[v/(R||1),j/(R||1)],D=ce(T,b,v,j),y=typeof a.delta=="number"?a.delta:a.delta[D.toLowerCase()]||w.delta;if(T<y&&b<y&&!i.swiping)return i;const L={absX:T,absY:b,deltaX:v,deltaY:j,dir:D,event:s,first:i.first,initial:i.initial,velocity:q,vxvy:K};L.first&&a.onSwipeStart&&a.onSwipeStart(L),a.onSwiping&&a.onSwiping(L);let S=!1;return(a.onSwiping||a.onSwiped||a[`onSwiped${D}`])&&(S=!0),S&&a.preventScrollOnSwipe&&a.trackTouch&&s.cancelable&&s.preventDefault(),Object.assign(Object.assign({},i),{first:!1,eventData:L,swiping:!0})})},l=s=>{e((i,a)=>{let _;if(i.swiping&&i.eventData){if(s.timeStamp-i.start<a.swipeDuration){_=Object.assign(Object.assign({},i.eventData),{event:s}),a.onSwiped&&a.onSwiped(_);const h=a[`onSwiped${_.dir}`];h&&h(_)}}else a.onTap&&a.onTap({event:s});return a.onTouchEndOrOnMouseUp&&a.onTouchEndOrOnMouseUp({event:s}),Object.assign(Object.assign(Object.assign({},i),A),{eventData:_})})},p=()=>{document.removeEventListener(V,o),document.removeEventListener(N,m)},m=s=>{p(),l(s)},f=(s,i)=>{let a=()=>{};if(s&&s.addEventListener){const _=Object.assign(Object.assign({},w.touchEventOptions),i.touchEventOptions),h=[[ae,c,_],[oe,o,Object.assign(Object.assign({},_),i.preventScrollOnSwipe?{passive:!1}:{})],[re,l,_]];h.forEach(([g,d,O])=>s.addEventListener(g,d,O)),a=()=>h.forEach(([g,d])=>s.removeEventListener(g,d))}return a},x={ref:s=>{s!==null&&e((i,a)=>{if(i.el===s)return i;const _={};return i.el&&i.el!==s&&i.cleanUpTouch&&(i.cleanUpTouch(),_.cleanUpTouch=void 0),a.trackTouch&&s&&(_.cleanUpTouch=f(s,a)),Object.assign(Object.assign(Object.assign({},i),{el:s}),_)})}};return r.trackMouse&&(x.onMouseDown=c),[x,f]}function _e(e,r,c,o){return!r.trackTouch||!e.el?(e.cleanUpTouch&&e.cleanUpTouch(),Object.assign(Object.assign({},e),{cleanUpTouch:void 0})):e.cleanUpTouch?r.preventScrollOnSwipe!==c.preventScrollOnSwipe||r.touchEventOptions.passive!==c.touchEventOptions.passive?(e.cleanUpTouch(),Object.assign(Object.assign({},e),{cleanUpTouch:o(e.el,r)})):e:Object.assign(Object.assign({},e),{cleanUpTouch:o(e.el,r)})}function ge(e){const{trackMouse:r}=e,c=u.useRef(Object.assign({},A)),o=u.useRef(Object.assign({},w)),l=u.useRef(Object.assign({},o.current));l.current=Object.assign({},o.current),o.current=Object.assign(Object.assign({},w),e);let p;for(p in w)o.current[p]===void 0&&(o.current[p]=w[p]);const[m,f]=u.useMemo(()=>ue(E=>c.current=E(c.current,o.current),{trackMouse:r}),[r]);return c.current=_e(c.current,o.current,l.current,f),m}const z=()=>n(()=>import("./DoorUI-PmVYcKt6.js"),__vite__mapDeps([0,1,2])),le=u.lazy(z),$=()=>n(()=>import("./ScratchReveal-oqKWemDj.js"),__vite__mapDeps([3,1,2])),pe=u.lazy($),X=()=>n(()=>import("./DumplingFillingUI-_Ixfn9J2.js"),__vite__mapDeps([4,1,2,5])),de=u.lazy(X),Y=()=>n(()=>import("./DumplingGivingUI-BybmAMWr.js"),__vite__mapDeps([6,1,2,5,7])),me=u.lazy(Y),fe=()=>n(()=>import("./LoveLanguagesUI-C2pDM1pv.js"),__vite__mapDeps([7,1,2])),I=u.lazy(fe),F=()=>n(()=>import("./StoryEndPage-DOnnd7Tx.js"),__vite__mapDeps([8,1,2]));u.lazy(F);const U=Object.assign({"/src/assets/pages/pg_0.png":()=>n(()=>import("./pg_0-C9kKzQ9e.js"),[]),"/src/assets/pages/pg_1.png":()=>n(()=>import("./pg_1-ERYTYsNx.js"),[]),"/src/assets/pages/pg_10.png":()=>n(()=>import("./pg_10-Bh0HdBaP.js"),[]),"/src/assets/pages/pg_11.png":()=>n(()=>import("./pg_11-BBfGdQWL.js"),[]),"/src/assets/pages/pg_12.png":()=>n(()=>import("./pg_12-DkDgt7GE.js"),[]),"/src/assets/pages/pg_13.png":()=>n(()=>import("./pg_13-DZEQP-hx.js"),[]),"/src/assets/pages/pg_14.png":()=>n(()=>import("./pg_14-Z2XBwkkw.js"),[]),"/src/assets/pages/pg_15.png":()=>n(()=>import("./pg_15-CvB1HR87.js"),[]),"/src/assets/pages/pg_16.png":()=>n(()=>import("./pg_16-An35zjFd.js"),[]),"/src/assets/pages/pg_17.png":()=>n(()=>import("./pg_17-CDFcGlzZ.js"),[]),"/src/assets/pages/pg_18.png":()=>n(()=>import("./pg_18-Dv8VxoX9.js"),[]),"/src/assets/pages/pg_19.png":()=>n(()=>import("./pg_19--1kQOyIX.js"),[]),"/src/assets/pages/pg_2.png":()=>n(()=>import("./pg_2-DxIO-mrO.js"),[]),"/src/assets/pages/pg_20.png":()=>n(()=>import("./pg_20-DsJ7YKXA.js"),[]),"/src/assets/pages/pg_21.png":()=>n(()=>import("./pg_21-semOzazQ.js"),[]),"/src/assets/pages/pg_22.png":()=>n(()=>import("./pg_22-0xN4vy0Q.js"),[]),"/src/assets/pages/pg_23.png":()=>n(()=>import("./pg_23-CSrCvE-W.js"),[]),"/src/assets/pages/pg_24.png":()=>n(()=>import("./pg_24-iM1z4pdo.js"),[]),"/src/assets/pages/pg_25.png":()=>n(()=>import("./pg_25-B3Zm7Zh9.js"),[]),"/src/assets/pages/pg_26.png":()=>n(()=>import("./pg_26-CqJmuRGx.js"),[]),"/src/assets/pages/pg_27.png":()=>n(()=>import("./pg_27-DVw06af_.js"),[]),"/src/assets/pages/pg_28.png":()=>n(()=>import("./pg_28-DukaBEc3.js"),[]),"/src/assets/pages/pg_29.png":()=>n(()=>import("./pg_29-BhRasWs7.js"),[]),"/src/assets/pages/pg_3.png":()=>n(()=>import("./pg_3-DzOvmfVh.js"),[]),"/src/assets/pages/pg_30.png":()=>n(()=>import("./pg_30-D4Cf6KWd.js"),[]),"/src/assets/pages/pg_31.png":()=>n(()=>import("./pg_31-B029ovnW.js"),[]),"/src/assets/pages/pg_32.png":()=>n(()=>import("./pg_32-QJtPaVXn.js"),[]),"/src/assets/pages/pg_33.png":()=>n(()=>import("./pg_33-CTX8h4ya.js"),[]),"/src/assets/pages/pg_4.png":()=>n(()=>import("./pg_4-DqITQBtt.js"),[]),"/src/assets/pages/pg_5.png":()=>n(()=>import("./pg_5-DpS5woq4.js"),[]),"/src/assets/pages/pg_6.png":()=>n(()=>import("./pg_6-Cddvn-5L.js"),[]),"/src/assets/pages/pg_7.png":()=>n(()=>import("./pg_7-Brun2mv9.js"),[]),"/src/assets/pages/pg_8.png":()=>n(()=>import("./pg_8-BKfY39WA.js"),[]),"/src/assets/pages/pg_9.png":()=>n(()=>import("./pg_9-BJVpGV9S.js"),[])}),he=()=>{const{currentPage:e,numPages:r,nextIsActive:c,handleBack:o,handleNext:l,toggleNext:p,direction:m}=P(),[f,E]=u.useState({});if(isNaN(e)||e<0||e>r)return t.jsx(Q,{to:"/not-found",replace:!0});const x=ge({onSwipedLeft:()=>l(),onSwipedRight:()=>o()});u.useEffect(()=>{const g=d=>{d.key==="ArrowLeft"?o():d.key==="ArrowRight"&&l()};return window.addEventListener("keydown",g),()=>window.removeEventListener("keydown",g)},[e,c]),u.useEffect(()=>{p(![3,5,15,17].includes(e))},[e]);const s=async g=>{const d=`/src/assets/pages/pg_${g}.png`;return U[d]?(await U[d]()).default:(console.log(`No image found for page: ${g}`),"")},i={3:z,5:$,15:X,17:Y,32:F};u.useEffect(()=>{(async()=>{const d=Array.from({length:5},(v,j)=>e-2+j),O={...f};for(const v of d)v>=0&&v<=r&&!O[v]&&(O[v]=await s(v)),i[v]&&i[v]();E(O)})()},[e]);const a=[4,6,16].includes(e),_=()=>a?{enter:()=>({opacity:0}),center:{opacity:1},exit:()=>({opacity:0})}:{enter:g=>({scale:.5,x:g>0?"100%":"-100%",opacity:0}),center:{scale:1,x:0,opacity:1},exit:g=>({scale:.5,x:g>0?"-100%":"100%",opacity:0})},h=()=>a?{ease:"easeOut",duration:.2}:{type:"spring",stiffness:500,damping:30,mass:.5,duration:.2};return t.jsx("div",{...x,children:t.jsx(k,{custom:m,initial:!1,children:f[e]?t.jsxs(C.div,{className:"absolute w-full h-full",custom:m,variants:_(),initial:"enter",animate:"center",exit:"exit",transition:h(),children:[t.jsx("img",{src:f[e],className:"object-contain pointer-events-none"}),e===3&&t.jsx(le,{}),e===5&&t.jsx(pe,{}),e===15&&t.jsx(de,{}),e===17&&t.jsx(me,{}),e===20&&t.jsx(I,{}),e===28&&t.jsx(I,{}),e===29&&t.jsx(I,{}),e===30&&t.jsx(I,{}),e===31&&t.jsx(I,{})]},e):t.jsx("p",{children:"Loading..."})})})},H=()=>{const{handleBack:e,backIsActive:r,currentPage:c}=P();return t.jsx("button",{onClick:e})},G=()=>{const{handleNext:e,nextIsActive:r}=P();return t.jsx("button",{onClick:e})},ve=()=>{const{currentPage:e,numPages:r}=P(),c=Math.round(e/r*100);return t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"bg-gray-100 h-2",children:t.jsx("div",{className:"bg-blue-primary h-full transition-all",style:{width:`${c}%`}})}),t.jsx("div",{className:"flex flex-col justify-center w-full h-12 progress-height-portrait bg-white",children:t.jsxs("div",{className:"flex flex-row justify-center items-center",children:[t.jsx("div",{className:"hidden show-portrait scale-75",children:t.jsx(H,{})}),t.jsxs("p",{className:"w-36 text-center",children:["Page ",e," of ",r]}),t.jsx("div",{className:"hidden show-portrait scale-75",children:t.jsx(G,{})})]})})]})};function Ee({onMiddleClick:e}){return u.useEffect(()=>{const r=c=>{const{clientX:o,clientY:l}=c,p=window.innerWidth,m=window.innerHeight,f=p*.3,E=p*.7,x=m*.3,s=m*.7;o>=f&&o<=E&&l>=x&&l<=s&&(e==null||e())};return window.addEventListener("click",r),()=>window.removeEventListener("click",r)},[e]),null}const xe=()=>{const[e,r]=u.useState(!1),{currentPage:c}=P();u.useEffect(()=>{if(!e)return;const l=setTimeout(()=>{r(!1)},3e3);return()=>clearTimeout(l)},[e]),u.useEffect(()=>{r(!1)},[c]);const o={enter:{y:"-100%",opacity:0},visible:{y:0,opacity:1},exit:{y:"-100%",opacity:0}};return t.jsxs(t.Fragment,{children:[t.jsx(Ee,{onMiddleClick:()=>r(!e)}),t.jsx(k,{children:e&&t.jsx(C.div,{variants:o,initial:"enter",animate:"visible",exit:"exit",transition:{duration:.3,ease:"easeOut"},className:"absolute top-0 w-full z-50",children:t.jsx(Z,{})})})]})};function Oe(){u.useEffect(()=>(document.body.classList.add("overflow-hidden"),()=>{document.body.classList.remove("overflow-hidden")}),[]);const e=u.useRef(null),[r,c]=u.useState(!0);return u.useEffect(()=>{const o=new ResizeObserver(([l])=>{const{width:p,height:m}=l.contentRect;c(p>m)});return e.current&&o.observe(e.current),()=>o.disconnect()},[]),t.jsx("div",{className:"w-screen h-[100dvh] flex flex-col ",children:t.jsxs(ee,{children:[t.jsx(xe,{}),t.jsxs("section",{ref:e,className:"flex w-full min-h-0 h-full items-center justify-evenly select-none z-0",children:[t.jsx("span",{className:"hide-portrait",children:t.jsx(H,{})}),t.jsx("div",{className:`relative  border-blue-tertiary overflow-clip aspect-square shadow-[3px_0_3px_-2px_rgba(0,0,0,0.1),_-3px_0_3px_-2px_rgba(0,0,0,0.1)]
              ${r?"h-full":"w-full"}`,children:t.jsx(he,{})}),t.jsx("span",{className:" hide-portrait ",children:t.jsx(G,{})})]}),t.jsx("div",{className:"shrink-0",children:t.jsx(ve,{})})]})})}const we=Object.freeze(Object.defineProperty({__proto__:null,default:Oe},Symbol.toStringTag,{value:"Module"}));export{we as R,P as u};
