import{R as m,r as u,j as h}from"./index-DaBL0HBu.js";import{u as B}from"./ReadPage-CPdAFSdS.js";function P(i,o){i.prototype=Object.create(o.prototype),i.prototype.constructor=i,v(i,o)}function v(i,o){return v=Object.setPrototypeOf||function(n,e){return n.__proto__=e,n},v(i,o)}var b=function(i){P(o,i);function o(n){var e;return e=i.call(this,n)||this,e.isDrawing=!1,e.lastPoint=null,e.isFinished=!1,e.reset=function(){e.canvas.style.opacity="1",e.ctx.globalCompositeOperation="source-over",e.ctx.drawImage(e.image,0,0,e.props.width,e.props.height),e.isFinished=!1},e.handleMouseDown=function(t){e.isDrawing=!0,e.lastPoint=e.getMouse(t,e.canvas)},e.handleMouseMove=function(t){if(e.isDrawing){t.preventDefault();for(var a=e.getMouse(t,e.canvas),c=e.distanceBetween(e.lastPoint,a),l=e.angleBetween(e.lastPoint,a),s,p,r=0;r<c;r++)s=e.lastPoint?e.lastPoint.x+Math.sin(l)*r:0,p=e.lastPoint?e.lastPoint.y+Math.cos(l)*r:0,e.ctx.globalCompositeOperation="destination-out",e.brushImage&&e.props.customBrush?e.ctx.drawImage(e.brushImage,s,p,e.props.customBrush.width,e.props.customBrush.height):(e.ctx.beginPath(),e.ctx.arc(s,p,e.props.brushSize||20,0,2*Math.PI,!1),e.ctx.fill());e.lastPoint=a,e.handlePercentage(e.getFilledInPixels(32))}},e.handleMouseUp=function(){e.isDrawing=!1},e.state={loaded:!1,finished:!1},e}var f=o.prototype;return f.componentDidMount=function(){var e=this;this.isDrawing=!1,this.lastPoint=null,this.ctx=this.canvas.getContext("2d"),this.image=new Image,this.image.crossOrigin="Anonymous",this.image.onload=function(){e.ctx.drawImage(e.image,0,0,e.props.width,e.props.height),e.setState({loaded:!0})},this.image.src=this.props.image,this.props.customBrush&&(this.brushImage=new Image(this.props.customBrush.width,this.props.customBrush.height),this.brushImage.src=this.props.customBrush.image)},f.getFilledInPixels=function(e){(!e||e<1)&&(e=1);var t=0,a=0,c=this.canvas.width,l=this.canvas.height;this.props.customCheckZone&&(t=this.props.customCheckZone.x,a=this.props.customCheckZone.y,c=this.props.customCheckZone.width,l=this.props.customCheckZone.height);for(var s=this.ctx.getImageData(t,a,c,l),p=s.data.length/e,r=0,d=0;d<s.data.length;d+=e)parseInt(s.data[d],10)===0&&r++;return Math.round(r/p*100)},f.getMouse=function(e,t){var a=t.getBoundingClientRect(),c=a.top,l=a.left,s=window.pageYOffset||document.documentElement.scrollTop,p=window.pageXOffset||document.documentElement.scrollLeft,r=0,d=0;return e&&e.pageX&&e.pageY?(r=e.pageX-l-p,d=e.pageY-c-s):e&&e.touches&&(r=e.touches[0].clientX-l-p,d=e.touches[0].clientY-c-s),{x:r,y:d}},f.distanceBetween=function(e,t){return e&&t?Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2)):0},f.angleBetween=function(e,t){return e&&t?Math.atan2(t.x-e.x,t.y-e.y):0},f.handlePercentage=function(e){if(e===void 0&&(e=0),!this.isFinished){var t=70;this.props.finishPercent!==void 0&&(t=this.props.finishPercent),e>t&&(this.props.fadeOutOnComplete!==!1&&(this.canvas.style.transition="1s",this.canvas.style.opacity="0"),this.setState({finished:!0}),this.props.onComplete&&this.props.onComplete(),this.isFinished=!0)}},f.render=function(){var e=this,t={width:this.props.width+"px",height:this.props.height+"px",position:"relative",WebkitUserSelect:"none",MozUserSelect:"none",msUserSelect:"none",userSelect:"none"},a={position:"absolute",top:0,zIndex:1},c={visibility:this.state.loaded?"visible":"hidden",width:"100%",height:"100%"};return m.createElement("div",{className:"ScratchCard__Container",style:t},m.createElement("canvas",{ref:function(s){e.canvas=s},className:"ScratchCard__Canvas",style:a,width:this.props.width,height:this.props.height,onMouseDown:this.handleMouseDown,onTouchStart:this.handleMouseDown,onMouseMove:this.handleMouseMove,onTouchMove:this.handleMouseMove,onMouseUp:this.handleMouseUp,onTouchEnd:this.handleMouseUp}),m.createElement("div",{className:"ScratchCard__Result",style:c},this.props.children))},o}(u.Component);const I="/afd-story/assets/thought-cloud-CN1sXxhU.png",j=({strokeWidth:i})=>h.jsxs("svg",{className:"absolute w-full h-auto scale-110 top-[-2.5%] left-[0%] animate-pulse-fast",width:"508",height:"366",viewBox:"0 0 508 366",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[h.jsx("g",{filter:"url(#filter0_f_1990_1444)",children:h.jsx("path",{d:"M498.731 189.034C496.748 156.414 476.01 129.134 446.651 114.201C448.934 106.671 449.991 98.7097 449.492 90.4938C446.892 47.7168 405.222 16.591 357.848 19.4703C337.654 20.6977 319.434 27.912 305.252 39.0011C290.826 19.7341 265.444 7.97345 237.571 9.66756C212.843 11.1705 191.383 22.944 178.467 40.1217C169.767 34.5395 158.902 31.562 147.353 32.2639C123.983 33.6843 104.574 49.9346 102.162 70.8183C96.7077 70.1297 91.0767 69.9144 85.3205 70.2642C41.5944 72.9218 6.79459 106.116 9.202 145.726C10.5762 168.336 23.8707 187.452 43.0426 199.14C25.3894 213.697 14.616 234.804 16.018 257.871C18.5354 299.291 58.8715 329.392 104.684 326.607C124.096 325.427 141.64 318.537 155.326 307.912C163.904 326.356 185.018 338.178 208.242 336.767C224.171 335.799 238.217 328.814 247.552 318.344C262.34 342.706 293.103 357.94 327.001 355.88C369.327 353.307 403.755 324.372 406.66 288.16C460.581 280.864 501.742 238.582 498.731 189.034Z",stroke:"#FFEC5B","stroke-opacity":"0.9","stroke-width":i})}),h.jsx("defs",{children:h.jsxs("filter",{id:"filter0_f_1990_1444",x:"0.0830078",y:"0.506348",width:"507.805",height:"364.559",filterUnits:"userSpaceOnUse","color-interpolation-filters":"sRGB",children:[h.jsx("feFlood",{"flood-opacity":"0",result:"BackgroundImageFix"}),h.jsx("feBlend",{mode:"normal",in:"SourceGraphic",in2:"BackgroundImageFix",result:"shape"}),h.jsx("feGaussianBlur",{stdDeviation:"3",result:"effect1_foregroundBlur_1990_1444"})]})})]}),D="/afd-story/assets/swipe-pointer-PGm7juiT.png",k=()=>{const i=u.useRef(null),[o,f]=u.useState({width:0,height:0}),{toggleNext:n,toggleBack:e}=B(),[t,a]=u.useState(!1);u.useEffect(()=>{const g=i.current;if(!g)return;const w=new ResizeObserver(C=>{for(let M of C){const{width:S,height:_}=M.contentRect;f({width:S,height:_})}});return w.observe(g),()=>{w.disconnect()}},[]);const[c,l]=u.useState(!1),[s,p]=u.useState(!1),[r,d]=u.useState("10");u.useEffect(()=>{d(c||s?"18":"10"),e(!s)},[c,s]),u.useEffect(()=>{t&&setTimeout(()=>{n(!0),e(!0)},1e3)},[t]);const[x,y]=u.useState(!1);return u.useEffect(()=>{const g=setTimeout(()=>{y(!0)},100);return()=>clearTimeout(g)},[]),h.jsxs("div",{ref:i,onMouseEnter:()=>l(!0),onMouseLeave:()=>l(!1),onTouchStart:()=>p(!0),onTouchEnd:()=>p(!1),className:`w-1/2 h-1/3 absolute 
        top-[3.5%] left-[24%] scale-95 ${!t&&"cursor-pointer"}`,children:[h.jsx("img",{src:D,className:`absolute w-1/6 h-auto scale-120 -translate-x-[50%] -translate-y-[50%] top-[61%] left-[101%] z-30 text-blue-400 fill-orange-100
     transition-opacity duration-1000
      ${x?"animate-bounce":""}
      ${t?"opacity-0":"opacity-100"}`}),h.jsx("span",{className:`transition-opacity duration-1000 ${t?"opacity-0":"opacity-100"}`,children:h.jsx(j,{strokeWidth:r})}),o.width>0&&o.height>0&&h.jsx(b,{width:o.width,height:o.height,image:I,finishPercent:55,fadeOutOnComplete:!0,onComplete:()=>a(!0)},`${o.width}-${o.height}`)]})};export{k as default};
