const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/DoorUI-BWMOcdjV.js","assets/index-CKDn_0z5.js","assets/index-BfZpX1Ys.css","assets/ScratchReveal-BPtboIwG.js","assets/DumplingFillingUI-Brn17_hV.js","assets/modifiers.esm-R6SksmHm.js","assets/DumplingGivingUI-Cte_AUNQ.js","assets/LoveLanguagesUI-DdN-cRaG.js","assets/StoryEndPage-GF0RRzwp.js"])))=>i.map(i=>d[i]);
import{u as J,a as Q,r as u,j as t,N as Z,A,m as S,_ as n,G as z,b as ee}from"./index-CKDn_0z5.js";const B=u.createContext(void 0),te=({children:e})=>{const r=J(),c=Q(),o=parseInt(c.pageNumber??"0",10),g=32,[p,h]=u.useState(!0),[f,x]=u.useState(!0),[E,s]=u.useState(0),i=()=>{p&&o<g&&(s(1),r(`/read/${o+1}`)),o===g&&r("/read/end")},a=()=>{f&&o>0&&(s(-1),r(`/read/${o-1}`))},l=_=>{h(_)},m=_=>{x(_)};return t.jsx(B.Provider,{value:{handleNext:i,handleBack:a,nextIsActive:p,backIsActive:f,currentPage:o,numPages:g,toggleNext:l,toggleBack:m,direction:E},children:e})},y=()=>{const e=u.useContext(B);if(!e)throw new Error("useReadContext must be used within a ReadContextProvider");return e},se="Left",ne="Right",ie="Up",re="Down",w={delta:10,preventScrollOnSwipe:!1,rotationAngle:0,trackMouse:!1,trackTouch:!0,swipeDuration:1/0,touchEventOptions:{passive:!0}},D={first:!0,initial:[0,0],start:0,swiping:!1,xy:[0,0]},k="mousemove",M="mouseup",oe="touchend",ae="touchmove",ce="touchstart";function ue(e,r,c,o){return e>r?c>0?ne:se:o>0?re:ie}function U(e,r){if(r===0)return e;const c=Math.PI/180*r,o=e[0]*Math.cos(c)+e[1]*Math.sin(c),g=e[1]*Math.cos(c)-e[0]*Math.sin(c);return[o,g]}function le(e,r){const c=s=>{const i="touches"in s;i&&s.touches.length>1||e((a,l)=>{l.trackMouse&&!i&&(document.addEventListener(k,o),document.addEventListener(M,h));const{clientX:m,clientY:_}=i?s.touches[0]:s,d=U([m,_],l.rotationAngle);return l.onTouchStartOrOnMouseDown&&l.onTouchStartOrOnMouseDown({event:s}),Object.assign(Object.assign(Object.assign({},a),D),{initial:d.slice(),xy:d,start:s.timeStamp||0})})},o=s=>{e((i,a)=>{const l="touches"in s;if(l&&s.touches.length>1)return i;if(s.timeStamp-i.start>a.swipeDuration)return i.swiping?Object.assign(Object.assign({},i),{swiping:!1}):i;const{clientX:m,clientY:_}=l?s.touches[0]:s,[d,O]=U([m,_],a.rotationAngle),v=d-i.xy[0],j=O-i.xy[1],T=Math.abs(v),I=Math.abs(j),P=(s.timeStamp||0)-i.start,q=Math.sqrt(T*T+I*I)/(P||1),K=[v/(P||1),j/(P||1)],R=ue(T,I,v,j),V=typeof a.delta=="number"?a.delta:a.delta[R.toLowerCase()]||w.delta;if(T<V&&I<V&&!i.swiping)return i;const L={absX:T,absY:I,deltaX:v,deltaY:j,dir:R,event:s,first:i.first,initial:i.initial,velocity:q,vxvy:K};L.first&&a.onSwipeStart&&a.onSwipeStart(L),a.onSwiping&&a.onSwiping(L);let N=!1;return(a.onSwiping||a.onSwiped||a[`onSwiped${R}`])&&(N=!0),N&&a.preventScrollOnSwipe&&a.trackTouch&&s.cancelable&&s.preventDefault(),Object.assign(Object.assign({},i),{first:!1,eventData:L,swiping:!0})})},g=s=>{e((i,a)=>{let l;if(i.swiping&&i.eventData){if(s.timeStamp-i.start<a.swipeDuration){l=Object.assign(Object.assign({},i.eventData),{event:s}),a.onSwiped&&a.onSwiped(l);const m=a[`onSwiped${l.dir}`];m&&m(l)}}else a.onTap&&a.onTap({event:s});return a.onTouchEndOrOnMouseUp&&a.onTouchEndOrOnMouseUp({event:s}),Object.assign(Object.assign(Object.assign({},i),D),{eventData:l})})},p=()=>{document.removeEventListener(k,o),document.removeEventListener(M,h)},h=s=>{p(),g(s)},f=(s,i)=>{let a=()=>{};if(s&&s.addEventListener){const l=Object.assign(Object.assign({},w.touchEventOptions),i.touchEventOptions),m=[[ce,c,l],[ae,o,Object.assign(Object.assign({},l),i.preventScrollOnSwipe?{passive:!1}:{})],[oe,g,l]];m.forEach(([_,d,O])=>s.addEventListener(_,d,O)),a=()=>m.forEach(([_,d])=>s.removeEventListener(_,d))}return a},E={ref:s=>{s!==null&&e((i,a)=>{if(i.el===s)return i;const l={};return i.el&&i.el!==s&&i.cleanUpTouch&&(i.cleanUpTouch(),l.cleanUpTouch=void 0),a.trackTouch&&s&&(l.cleanUpTouch=f(s,a)),Object.assign(Object.assign(Object.assign({},i),{el:s}),l)})}};return r.trackMouse&&(E.onMouseDown=c),[E,f]}function _e(e,r,c,o){return!r.trackTouch||!e.el?(e.cleanUpTouch&&e.cleanUpTouch(),Object.assign(Object.assign({},e),{cleanUpTouch:void 0})):e.cleanUpTouch?r.preventScrollOnSwipe!==c.preventScrollOnSwipe||r.touchEventOptions.passive!==c.touchEventOptions.passive?(e.cleanUpTouch(),Object.assign(Object.assign({},e),{cleanUpTouch:o(e.el,r)})):e:Object.assign(Object.assign({},e),{cleanUpTouch:o(e.el,r)})}function ge(e){const{trackMouse:r}=e,c=u.useRef(Object.assign({},D)),o=u.useRef(Object.assign({},w)),g=u.useRef(Object.assign({},o.current));g.current=Object.assign({},o.current),o.current=Object.assign(Object.assign({},w),e);let p;for(p in w)o.current[p]===void 0&&(o.current[p]=w[p]);const[h,f]=u.useMemo(()=>le(x=>c.current=x(c.current,o.current),{trackMouse:r}),[r]);return c.current=_e(c.current,o.current,g.current,f),h}const $=()=>n(()=>import("./DoorUI-BWMOcdjV.js"),__vite__mapDeps([0,1,2])),pe=u.lazy($),F=()=>n(()=>import("./ScratchReveal-BPtboIwG.js"),__vite__mapDeps([3,1,2])),de=u.lazy(F),X=()=>n(()=>import("./DumplingFillingUI-Brn17_hV.js"),__vite__mapDeps([4,1,2,5])),he=u.lazy(X),Y=()=>n(()=>import("./DumplingGivingUI-Cte_AUNQ.js"),__vite__mapDeps([6,1,2,5,7])),fe=u.lazy(Y),me=()=>n(()=>import("./LoveLanguagesUI-DdN-cRaG.js"),__vite__mapDeps([7,1,2])),b=u.lazy(me),G=()=>n(()=>import("./StoryEndPage-GF0RRzwp.js"),__vite__mapDeps([8,1,2]));u.lazy(G);const C=Object.assign({"/src/assets/pages/pg_0.png":()=>n(()=>import("./pg_0-C9kKzQ9e.js"),[]),"/src/assets/pages/pg_1.png":()=>n(()=>import("./pg_1-ERYTYsNx.js"),[]),"/src/assets/pages/pg_10.png":()=>n(()=>import("./pg_10-Bh0HdBaP.js"),[]),"/src/assets/pages/pg_11.png":()=>n(()=>import("./pg_11-BBfGdQWL.js"),[]),"/src/assets/pages/pg_12.png":()=>n(()=>import("./pg_12-DkDgt7GE.js"),[]),"/src/assets/pages/pg_13.png":()=>n(()=>import("./pg_13-DZEQP-hx.js"),[]),"/src/assets/pages/pg_14.png":()=>n(()=>import("./pg_14-Z2XBwkkw.js"),[]),"/src/assets/pages/pg_15.png":()=>n(()=>import("./pg_15-CvB1HR87.js"),[]),"/src/assets/pages/pg_16.png":()=>n(()=>import("./pg_16-An35zjFd.js"),[]),"/src/assets/pages/pg_17.png":()=>n(()=>import("./pg_17-CDFcGlzZ.js"),[]),"/src/assets/pages/pg_18.png":()=>n(()=>import("./pg_18-Dv8VxoX9.js"),[]),"/src/assets/pages/pg_19.png":()=>n(()=>import("./pg_19--1kQOyIX.js"),[]),"/src/assets/pages/pg_2.png":()=>n(()=>import("./pg_2-DxIO-mrO.js"),[]),"/src/assets/pages/pg_20.png":()=>n(()=>import("./pg_20-DsJ7YKXA.js"),[]),"/src/assets/pages/pg_21.png":()=>n(()=>import("./pg_21-semOzazQ.js"),[]),"/src/assets/pages/pg_22.png":()=>n(()=>import("./pg_22-0xN4vy0Q.js"),[]),"/src/assets/pages/pg_23.png":()=>n(()=>import("./pg_23-CSrCvE-W.js"),[]),"/src/assets/pages/pg_24.png":()=>n(()=>import("./pg_24-iM1z4pdo.js"),[]),"/src/assets/pages/pg_25.png":()=>n(()=>import("./pg_25-B3Zm7Zh9.js"),[]),"/src/assets/pages/pg_26.png":()=>n(()=>import("./pg_26-CqJmuRGx.js"),[]),"/src/assets/pages/pg_27.png":()=>n(()=>import("./pg_27-DVw06af_.js"),[]),"/src/assets/pages/pg_28.png":()=>n(()=>import("./pg_28-DukaBEc3.js"),[]),"/src/assets/pages/pg_29.png":()=>n(()=>import("./pg_29-BhRasWs7.js"),[]),"/src/assets/pages/pg_3.png":()=>n(()=>import("./pg_3-DzOvmfVh.js"),[]),"/src/assets/pages/pg_30.png":()=>n(()=>import("./pg_30-D4Cf6KWd.js"),[]),"/src/assets/pages/pg_31.png":()=>n(()=>import("./pg_31-B029ovnW.js"),[]),"/src/assets/pages/pg_32.png":()=>n(()=>import("./pg_32-QJtPaVXn.js"),[]),"/src/assets/pages/pg_33.png":()=>n(()=>import("./pg_33-CTX8h4ya.js"),[]),"/src/assets/pages/pg_4.png":()=>n(()=>import("./pg_4-DqITQBtt.js"),[]),"/src/assets/pages/pg_5.png":()=>n(()=>import("./pg_5-DpS5woq4.js"),[]),"/src/assets/pages/pg_6.png":()=>n(()=>import("./pg_6-Cddvn-5L.js"),[]),"/src/assets/pages/pg_7.png":()=>n(()=>import("./pg_7-Brun2mv9.js"),[]),"/src/assets/pages/pg_8.png":()=>n(()=>import("./pg_8-BKfY39WA.js"),[]),"/src/assets/pages/pg_9.png":()=>n(()=>import("./pg_9-BJVpGV9S.js"),[])}),ve=()=>{const{currentPage:e,numPages:r,nextIsActive:c,handleBack:o,handleNext:g,toggleNext:p,direction:h}=y(),[f,x]=u.useState({});if(isNaN(e)||e<0||e>r)return t.jsx(Z,{to:"/not-found",replace:!0});const E=ge({onSwipedLeft:()=>g(),onSwipedRight:()=>o()});u.useEffect(()=>{const _=d=>{d.key==="ArrowLeft"?o():d.key==="ArrowRight"&&g()};return window.addEventListener("keydown",_),()=>window.removeEventListener("keydown",_)},[e,c]),u.useEffect(()=>{p(![3,5,15,17].includes(e))},[e]);const s=async _=>{const d=`/src/assets/pages/pg_${_}.png`;return C[d]?(await C[d]()).default:(console.log(`No image found for page: ${_}`),"")},i={3:$,5:F,15:X,17:Y,32:G};u.useEffect(()=>{(async()=>{const d=Array.from({length:5},(v,j)=>e-2+j),O={...f};for(const v of d)v>=0&&v<=r&&!O[v]&&(O[v]=await s(v)),i[v]&&i[v]();x(O)})()},[e]);const a=[4,6,16].includes(e),l=()=>a?{enter:()=>({opacity:0}),center:{opacity:1},exit:()=>({opacity:0})}:{enter:_=>({scale:.5,x:_>0?"100%":"-100%",opacity:0}),center:{scale:1,x:0,opacity:1},exit:_=>({scale:.5,x:_>0?"-100%":"100%",opacity:0})},m=()=>a?{ease:"easeOut",duration:.2}:{type:"spring",stiffness:500,damping:30,mass:.5,duration:.2};return t.jsx("div",{...E,children:t.jsx(A,{custom:h,initial:!1,children:f[e]?t.jsxs(S.div,{className:"absolute w-full h-full",custom:h,variants:l(),initial:"enter",animate:"center",exit:"exit",transition:m(),children:[t.jsx("img",{src:f[e],className:"object-contain pointer-events-none"}),e===3&&t.jsx(pe,{}),e===5&&t.jsx(de,{}),e===15&&t.jsx(he,{}),e===17&&t.jsx(fe,{}),e===20&&t.jsx(b,{}),e===28&&t.jsx(b,{}),e===29&&t.jsx(b,{}),e===30&&t.jsx(b,{}),e===31&&t.jsx(b,{})]},e):t.jsx("p",{children:"Loading..."})})})};function xe(e){return z({attr:{viewBox:"0 0 320 512"},child:[{tag:"path",attr:{d:"M9.4 233.4c-12.5 12.5-12.5 32.8 0 45.3l192 192c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L77.3 256 246.6 86.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-192 192z"},child:[]}]})(e)}function Ee(e){return z({attr:{viewBox:"0 0 320 512"},child:[{tag:"path",attr:{d:"M310.6 233.4c12.5 12.5 12.5 32.8 0 45.3l-192 192c-12.5 12.5-32.8 12.5-45.3 0s-12.5-32.8 0-45.3L242.7 256 73.4 86.6c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0l192 192z"},child:[]}]})(e)}const H=()=>{const{handleBack:e,backIsActive:r,currentPage:c}=y();return t.jsx("button",{onClick:e,children:t.jsx("span",{className:`flex w-12 h-12 items-center justify-center rounded-full transition
        ${c===0&&"opacity-0 "}
        ${r?"text-sky-300  hover:text-sky-500 active:text-sky-500 cursor-pointer":"text-gray-200 cursor-not-allowed"}
      `,style:{strokeWidth:13},children:xe({size:58})})})},W=()=>{const{handleNext:e,nextIsActive:r}=y();return t.jsx("button",{onClick:e,children:t.jsx("span",{className:`flex w-12 h-12 items-center justify-center rounded-full transition
        ${r?"text-sky-300  hover:text-sky-500 active:text-sky-500 cursor-pointer":"text-gray-200 cursor-not-allowed"}
      `,style:{strokeWidth:13},children:Ee({size:58})})})},Oe=()=>{const{currentPage:e,numPages:r}=y(),c=Math.round(e/r*100);return t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"bg-gray-100 h-2",children:t.jsx("div",{className:"bg-blue-primary h-full transition-all",style:{width:`${c}%`}})}),t.jsx("div",{className:"flex flex-col justify-center w-full h-12 progress-height-portrait bg-white",children:t.jsxs("div",{className:"flex flex-row justify-center items-center",children:[t.jsx("div",{className:"hidden show-portrait scale-75",children:t.jsx(H,{})}),t.jsxs("p",{className:"w-36 text-center",children:["Page ",e," of ",r]}),t.jsx("div",{className:"hidden show-portrait scale-75",children:t.jsx(W,{})})]})})]})};function je({onMiddleClick:e}){return u.useEffect(()=>{const r=c=>{const{clientX:o,clientY:g}=c,p=window.innerWidth,h=window.innerHeight,f=p*.1,x=p*.9,E=h*.1,s=h*.9;o>=f&&o<=x&&g>=E&&g<=s&&(e==null||e())};return window.addEventListener("click",r),()=>window.removeEventListener("click",r)},[e]),null}const we=()=>{const[e,r]=u.useState(!1),{currentPage:c}=y();u.useEffect(()=>{if(!e)return;const g=setTimeout(()=>{r(!1)},3e3);return()=>clearTimeout(g)},[e]),u.useEffect(()=>{r(!1)},[c]);const o={enter:{y:"-100%",opacity:0},visible:{y:0,opacity:1},exit:{y:"-100%",opacity:0}};return t.jsxs(t.Fragment,{children:[t.jsx(je,{onMiddleClick:()=>r(!e)}),t.jsx(A,{children:e&&t.jsx(S.div,{variants:o,initial:"enter",animate:"visible",exit:"exit",transition:{duration:.3,ease:"easeOut"},className:"absolute top-0 w-full z-50",children:t.jsx(ee,{})})})]})};function Te(){u.useEffect(()=>(document.body.classList.add("overflow-hidden"),()=>{document.body.classList.remove("overflow-hidden")}),[]);const e=u.useRef(null),[r,c]=u.useState(!0);return u.useEffect(()=>{const o=new ResizeObserver(([g])=>{const{width:p,height:h}=g.contentRect;c(p>h)});return e.current&&o.observe(e.current),()=>o.disconnect()},[]),t.jsx(A,{children:t.jsx(S.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:1,ease:"easeOut"},className:"w-screen h-[100dvh] flex flex-col ",children:t.jsxs(te,{children:[t.jsx(we,{}),t.jsxs("section",{ref:e,className:"flex w-full min-h-0 h-full items-center justify-evenly select-none z-0",children:[t.jsx("span",{className:"hide-portrait",children:t.jsx(H,{})}),t.jsx("div",{className:`relative  border-blue-tertiary overflow-clip aspect-square shadow-[3px_0_3px_-2px_rgba(0,0,0,0.1),_-3px_0_3px_-2px_rgba(0,0,0,0.1)]
              ${r?"h-full":"w-full"}`,children:t.jsx(ve,{})}),t.jsx("span",{className:" hide-portrait ",children:t.jsx(W,{})})]}),t.jsx("div",{className:"shrink-0",children:t.jsx(Oe,{})})]})})})}const be=Object.freeze(Object.defineProperty({__proto__:null,default:Te},Symbol.toStringTag,{value:"Module"}));export{be as R,y as u};
