import { useDraggable } from "@dnd-kit/core";
import { CSS } from "@dnd-kit/utilities";
import dumplingImage from "/src/assets/UI/DumplingGiving/heart-dumpling.png";

interface Props {
  dropped: boolean;
}

const DumplingHeart = ({ dropped }: Props) => {
  const { attributes, listeners, setNodeRef, transform, isDragging } =
    useDraggable({
      id: "draggable",
      disabled: dropped,
    });
  // updates position of the element as it is dragged
  const style = {
    transform: CSS.Translate.toString(transform),
  };

  const initialStyle = "top-[78%] left-[61.5%] cursor-grab hover:scale-105";
  const droppedStyle = "top-[72%] left-[19%] transition-none";

  const glowSVG = (
    // old glow
    // <defs>
    //   <filter
    //     id="filter0_f_1985_1286"
    //     x="0.723633"
    //     y="0.711182"
    //     width="203.566"
    //     height="189.135"
    //     filterUnits="userSpaceOnUse"
    //     // color-interpolation-filters="sRGB"
    //   >
    //     <feFlood flood-opacity="0" result="BackgroundImageFix" />
    //     <feBlend
    //       mode="normal"
    //       in="SourceGraphic"
    //       in2="BackgroundImageFix"
    //       result="shape"
    //     />
    //     <feGaussianBlur
    //       stdDeviation="4"
    //       result="effect1_foregroundBlur_1985_1286"
    //     />
    //   </filter>
    // </defs>
    <div>
      {/* yellow glow */}
      <svg
        className={`w-full h-auto absolute scale-118 z-10 
        ${isDragging ? "animate-none" : "animate-pulse-fast"}
        ${dropped ? "invisible" : ""} `}
        width="229"
        height="219"
        viewBox="0 0 229 219"
        fill="none"
        xmlns="http://www.w3.org/2000/svg"
      >
        <g filter="url(#filter0_f_3744_1317)">
          <path
            d="M61.2832 20.749C68.3163 19.3002 75.0931 20.245 80.3066 21.165L80.3271 21.168L80.3467 21.1719C87.2826 22.4246 95.06 25.7921 101.861 30.0117C105.11 32.0275 108.379 34.3897 111.386 37.0352C116.591 32.3858 122.619 29.2169 128.298 26.9561C139.863 21.1715 152.452 20.975 162.678 21.3438C163.651 21.3458 164.651 21.3136 165.923 21.2773C167.16 21.2421 168.631 21.205 170.149 21.2412C173.18 21.3135 176.996 21.6796 180.91 23.292L180.911 23.291C198.539 30.5476 207.646 46.7559 207.825 64.4863C208.024 69.1056 208.509 76.3016 206.191 83.2578C203.571 91.6418 198.559 99.282 195.455 104.769L195.163 105.286L194.811 105.765C193.222 107.928 191.426 109.713 190.181 110.951C188.768 112.356 187.959 113.162 187.296 114.006L186.89 114.524L186.418 114.984C184.688 116.673 183.027 118.512 181.151 120.611C179.395 122.577 177.41 124.813 175.279 126.969C170.113 132.705 164.583 137.961 159.156 142.911C154.744 147.055 149.902 150.619 145.766 153.742C141.41 157.031 137.679 159.942 134.478 163.245L134.39 163.337L134.299 163.425C129.793 167.844 126.022 173.241 122.193 179.409C120.686 181.853 119.054 184.228 117.63 186.323C116.397 188.516 114.137 191.424 110.493 192.985C108.167 193.982 105.084 194.47 101.814 193.389C98.6524 192.342 96.5066 190.221 95.1494 188.258L94.9502 187.97L94.7715 187.669C93.7968 186.024 93.1518 184.276 92.8418 182.479C92.6971 182.209 92.5133 181.864 92.2686 181.391L92.2109 181.278L92.1553 181.164C90.6146 177.989 88.6451 174.891 86.335 171.68C83.5154 168.364 81.4998 165.799 79.0439 163.251L78.2803 162.48C76.4844 160.69 74.5843 158.931 72.5195 157.021C70.2834 154.953 67.8469 152.699 65.4863 150.295C61.4596 146.61 57.6759 142.242 54.7236 139.098C50.2795 134.672 45.9197 129.998 41.8428 124.948C38.3589 121.097 32.1799 115.211 28.2852 108.411L28.1895 108.244L28.0996 108.073C22.6269 97.6021 19.3424 85.3913 20.1152 72.8926C20.106 63.038 22.5191 53.3872 27.1797 44.6924C30.203 38.9285 35.1529 34.662 37.8516 32.127L38.252 31.751L38.6914 31.4209C45.1556 26.5639 52.8105 22.7196 61.0322 20.8047L61.1572 20.7754L61.2832 20.749ZM69.832 45.1074C67.8239 44.5698 65.626 44.8854 62.5967 46.7266C59.3752 48.6845 56.1772 51.8053 52.8271 55.4473L52.6045 55.6895L52.3672 55.916C49.4826 58.6655 47.2029 62.3204 45.626 66.543C44.9271 70.6148 45.8664 74.9981 47.0762 82.1445C48.6572 89.5432 49.3335 93.6949 50.8701 97.6367C52.0939 100.776 53.9136 103.772 57.8525 107.395L58.6699 108.128L58.9307 108.357L59.1758 108.604C60.901 110.343 62.8635 111.98 65.2227 113.893C67.4255 115.678 70.0876 117.794 72.5967 120.123C80.3784 127.024 88.237 134.478 95.209 143.014L95.8828 143.846L95.9355 143.912C98.686 147.396 100.996 151.068 103.002 154.27C103.878 155.669 104.699 156.98 105.501 158.223C110.796 152.517 116.69 147.609 121.011 143.515C122.948 141.572 124.788 139.515 126.912 137.171C128.992 134.875 131.316 132.337 133.878 129.916L134.08 129.725L134.292 129.546C136.056 128.055 137.752 126.372 139.732 124.371C141.554 122.531 143.68 120.358 145.982 118.299C148.993 115.29 152.807 112.411 154.974 110.614C158.952 106.907 163.353 102.834 168.19 99.1826L168.36 99.0537L168.536 98.9326C169.797 98.0625 171.069 96.8073 172.827 94.833L172.866 94.7891L172.905 94.7461C173.118 94.5128 173.327 94.2874 173.51 94.0908C173.701 93.8851 173.86 93.7137 174.018 93.542C174.332 93.1998 174.548 92.9535 174.718 92.7471C174.838 92.601 174.911 92.4986 174.954 92.4375C177.507 85.6067 179.786 79.4939 181.221 73.2529C181.9 67.3409 182.5 63.031 182.122 58.834C182.04 58.5719 181.834 58.1067 181.288 57.3555C180.533 56.3171 179.584 55.3136 178.105 53.7578C177.042 52.8073 175.72 51.9837 173.307 50.4629L173.202 50.3965L173.1 50.3281C170.058 48.305 168.776 47.7064 167.751 47.5586L167.35 47.501L166.954 47.4102C157.384 45.2277 149.716 45.6554 141.948 49.6377L141.44 49.8984L140.907 50.0986C134.295 52.5858 129.811 55.098 126.222 59.1465C126.085 60.1229 125.84 61.1074 125.464 62.085C124.265 65.2013 122.024 67.5084 119.447 68.8809C115.495 70.9863 110.376 71.0442 106.231 68.5049C103.22 67.1944 101.142 64.8384 99.834 62.6582C97.0787 59.407 93.7346 56.4409 89.9238 53.5557C84.5185 49.6004 77.7515 47.0957 69.9844 45.1475L69.9082 45.1279L69.832 45.1074Z"
            stroke="#FFEC5B"
            stroke-opacity="0.9"
            stroke-width="25"
            // stroke-width={isDragging ? "0" : "20"} //disable glow while dragging
          />
        </g>
        <defs>
          <filter
            id="filter0_f_3744_1317"
            x="0"
            y="0.00195312"
            width="228.012"
            height="218.92"
            filterUnits="userSpaceOnUse"
            color-interpolation-filters="sRGB"
          >
            <feFlood flood-opacity="0" result="BackgroundImageFix" />
            <feBlend
              mode="normal"
              in="SourceGraphic"
              in2="BackgroundImageFix"
              result="shape"
            />
            <feGaussianBlur
              stdDeviation="5"
              result="effect1_foregroundBlur_3744_1317"
            />
          </filter>
        </defs>
      </svg>
      {/* inner glow */}
      <svg
        className={`w-full h-auto absolute scale-106 z-20 
        ${dropped ? "invisible" : ""} `}
        width="196"
        height="182"
        viewBox="0 0 196 182"
        fill="none"
        xmlns="http://www.w3.org/2000/svg"
      >
        <g filter="url(#filter0_f_3747_1329)">
          <path
            d="M46.4932 10.626C51.9753 9.49661 57.4322 10.0859 62.2988 10.9062L63.2646 11.0732L63.2725 11.0752L63.2803 11.0762C69.2656 12.1572 76.3316 15.1604 82.6982 19.1104C87.3959 22.0248 91.9435 25.5993 95.502 29.5527C100.675 23.2264 107.772 19.1846 114.773 16.4277C124.98 11.2472 136.373 10.9705 146.584 11.3438C147.703 11.3481 148.84 11.3101 150.094 11.2744C151.329 11.2392 152.661 11.2072 154.007 11.2393C156.696 11.3034 159.68 11.626 162.626 12.8398C177.782 19.0787 185.72 32.9839 185.827 48.7002C186.036 53.5995 186.409 59.629 184.499 65.3613C182.143 72.9756 177.647 79.7794 174.233 85.8145L174.116 86.0205L173.976 86.2129C172.697 87.9529 171.217 89.4367 169.949 90.6973C168.615 92.0244 167.515 93.107 166.578 94.2998L166.415 94.5068L166.227 94.6914C164.332 96.5413 162.545 98.5232 160.677 100.613C158.86 102.646 156.954 104.794 154.92 106.846C149.922 112.406 144.524 117.542 139.112 122.479C134.974 126.374 130.408 129.739 126.15 132.954C121.804 136.236 117.73 139.396 114.169 143.069L114.134 143.106L114.098 143.142C109.075 148.068 105.003 153.948 101.102 160.233C99.6193 162.639 98.014 164.969 96.5127 167.181C95.6956 168.71 94.2491 170.563 92.1299 171.471C90.8902 172.002 89.331 172.232 87.6992 171.692C86.1103 171.167 84.9292 170.068 84.084 168.846L84.0049 168.73L83.9336 168.61C83.1745 167.329 82.7579 165.993 82.6543 164.645C82.3673 164.071 82.0419 163.493 81.5986 162.636L81.5752 162.591L81.5537 162.545C79.7805 158.89 77.557 155.428 75.0762 151.993C72.3411 148.784 70.0151 145.834 67.3291 143.052L66.5215 142.236C64.6239 140.344 62.6414 138.511 60.5938 136.617C58.3073 134.502 55.9392 132.31 53.667 129.989C49.8086 126.48 46.323 122.422 43.0723 118.963C38.6487 114.563 34.3671 109.969 30.3975 105.039C26.4213 100.62 21.0028 95.5601 17.4912 89.4287L17.4531 89.3623L17.418 89.2939C12.326 79.5511 9.37264 68.3471 10.1152 57.0576C10.0786 48.1014 12.264 39.334 16.5127 31.4414C18.9602 26.7978 22.973 23.3049 25.959 20.5L26.1191 20.3496L26.2949 20.2178C32.1772 15.798 39.0814 12.3515 46.3936 10.6484L46.4434 10.6367L46.4932 10.626ZM55.3828 23.3115C51.2992 22.2185 47.4021 23.2153 43.4805 25.5986C39.4817 28.029 35.7999 31.7017 32.4111 35.3857L32.3223 35.4824L32.2275 35.5732C28.4481 39.1757 25.6548 43.837 23.8193 48.9531C22.7026 54.5515 24.0214 60.4067 25.1816 67.2676C26.695 74.34 27.5046 79.2628 29.2793 83.8154C30.9104 87.9995 33.38 91.8529 38.2354 96.2148L38.7129 96.6387L38.8174 96.7305L38.915 96.8291C40.8926 98.8233 43.0833 100.64 45.4443 102.554C47.7388 104.414 50.232 106.395 52.5703 108.571C60.2812 115.407 67.8781 122.626 74.5605 130.808L75.2051 131.604L75.2158 131.616L75.2266 131.63C77.747 134.823 79.8974 138.229 81.918 141.455C83.8458 144.533 85.652 147.439 87.6709 150.159L88.0771 150.701L88.1914 150.851L88.291 151.011C88.5232 151.384 88.7708 151.757 89.0322 152.137L89.1113 152.029C94.9367 144.128 102.835 137.854 109.201 131.811C111.289 129.722 113.261 127.515 115.358 125.199C117.437 122.904 119.624 120.522 121.999 118.276L122.08 118.2L122.165 118.128C124.157 116.444 126.023 114.585 127.996 112.592C129.902 110.667 131.928 108.596 134.108 106.657C136.928 103.811 140.339 101.294 142.932 99.1289C146.967 95.3679 151.196 91.4495 155.805 87.9707L155.873 87.9199L155.943 87.8711C157.828 86.5709 159.494 84.8598 161.308 82.8232L161.323 82.8066L161.339 82.7891C163.023 80.9425 163.937 80.0485 164.451 78.8721C167.063 71.8835 169.583 65.1936 171.143 58.2744C171.819 52.3579 172.592 47.086 172.062 41.8955C171.524 39.0293 169.381 36.7032 166.283 33.4434C164.699 31.9883 162.822 30.8459 160.505 29.3857L160.463 29.3594L160.422 29.332C157.456 27.3593 155.137 25.9849 152.606 25.6201L152.446 25.5967L152.288 25.5605C141.732 23.1532 132.548 23.5121 123.211 28.2988L123.008 28.4023L122.795 28.4834C114.92 31.4455 109.069 34.7485 104.344 40.8418C104.393 41.8937 104.247 42.9379 103.864 43.9316C103.22 45.6057 102.021 46.8428 100.626 47.5859C98.3209 48.8137 95.3055 48.7629 92.9893 47.1396C91.0873 46.4421 89.689 44.8895 88.7734 43.2139C85.5594 39.3305 81.7135 35.9239 77.5215 32.752C71.1904 28.1031 63.5323 25.3569 55.4443 23.3281L55.4141 23.3203L55.3828 23.3115Z"
            stroke="white"
            stroke-opacity="1"
            stroke-width="8"
          />
        </g>
        <defs>
          <filter
            id="filter0_f_3747_1329"
            x="0"
            y="0.00195312"
            width="196.005"
            height="181.998"
            filterUnits="userSpaceOnUse"
            color-interpolation-filters="sRGB"
          >
            <feFlood flood-opacity="0" result="BackgroundImageFix" />
            <feBlend
              mode="normal"
              in="SourceGraphic"
              in2="BackgroundImageFix"
              result="shape"
            />
            <feGaussianBlur
              stdDeviation="3"
              result="effect1_foregroundBlur_3747_1329"
            />
          </filter>
        </defs>
      </svg>
    </div>
  );

  const shadowSVG = (
    // <defs>
    //   <filter id="filter0_f_1985_1286">
    //     <feOffset in="SourceGraphic" dx="5" dy="3" />
    //     <feBlend
    //       mode="normal"
    //       in="SourceGraphic"
    //       in2="BackgroundImageFix"
    //       result="shape"
    //     />
    //     <feGaussianBlur
    //       stdDeviation="2"
    //       result="effect1_foregroundBlur_1985_1286"
    //     />
    //   </filter>
    // </defs>
    <svg
      className={`w-full h-auto absolute scale-95 z-10 top-[5%]
      ${dropped ? "invisible" : ""} `}
      width="176"
      height="164"
      viewBox="0 0 176 164"
      fill="none"
      xmlns="http://www.w3.org/2000/svg"
    >
      <g filter="url(#filter0_d_3744_1316)">
        <path
          fill-rule="evenodd"
          clip-rule="evenodd"
          d="M37.3005 0.54371C42.3576 -0.498107 47.5373 0.124488 52.569 1.01246C63.2723 2.94558 78.935 12.0542 85.5212 22.0652C86.1614 21.1452 86.8968 20.276 87.5681 19.4177C92.2178 13.0244 99.1609 8.91448 106.408 6.08277C115.705 1.30013 126.299 0.965242 136.531 1.34352C141.382 1.36604 146.503 0.641276 151.104 2.53785C164.598 8.09237 171.756 20.4427 171.829 34.8035C172.045 39.9123 172.344 45.1735 170.704 50.0974C168.524 57.2002 164.376 63.437 160.752 69.8445C158.609 72.7605 155.671 74.9785 153.432 77.8289C149.422 81.7435 145.951 86.1381 142.004 90.1072C137.121 95.546 131.816 100.598 126.417 105.523C118.506 112.984 108.897 118.444 101.297 126.286C95.9242 131.555 91.6507 137.766 87.697 144.136C86.231 146.514 84.6424 148.812 83.0749 151.124C81.9394 153.399 79.3902 155.487 77.3747 152.571C76.7939 151.591 76.5845 150.637 76.6345 149.708C76.1972 148.712 75.6514 147.764 75.1521 146.799C73.2214 142.819 70.827 139.114 68.236 135.535C65.5778 132.422 63.0322 129.197 60.1862 126.252C55.7439 121.718 50.8735 117.644 46.4401 113.105C42.6898 109.707 39.4139 105.867 35.9509 102.184C31.5459 97.806 27.323 93.2725 23.4323 88.4304C19.0997 83.6051 14.2101 79.1114 10.9626 73.4412C6.1256 64.1863 3.39495 53.6587 4.11397 43.1834C4.05619 34.8443 6.08036 26.6837 10.0349 19.3377C12.0953 15.4093 15.5068 12.4134 18.698 9.41578C24.1922 5.28758 30.5948 2.1055 37.3005 0.54371ZM46.4177 5.44801C35.4821 2.52041 26.2967 11.2534 19.4675 18.6775C15.0887 22.8512 11.9594 28.1795 9.95772 33.8689C8.54435 40.508 10.1405 47.4288 11.2517 54.0144C14.184 67.6994 14.8477 75.7964 26.0749 85.6453C30.3666 89.9731 35.4426 93.391 39.8981 97.5476C47.8055 104.557 55.4547 111.852 62.0866 120.108C66.8208 126.105 70.2598 133.027 74.8933 139.122C76.1099 141.079 77.5873 142.894 78.8952 144.802C80.0722 143.257 81.4449 141.793 82.3308 140.403C87.8893 132.864 95.2567 127.076 101.995 120.675C106.371 116.301 110.244 111.439 114.747 107.183C119.035 103.559 122.665 99.2764 126.865 95.5584C129.551 92.8254 132.645 90.5875 135.57 88.1375C139.649 84.3354 143.762 80.5246 148.215 77.1638C150.515 75.5768 152.444 73.5622 154.295 71.4841C155.734 69.906 157.308 68.3847 158.156 66.3855C160.783 59.3541 163.454 52.3023 165.091 44.9578C165.752 39.1309 166.651 33.1861 166.025 27.3279C165.272 22.9483 162.03 19.6827 159.088 16.5877C157.149 14.7828 154.87 13.4081 152.637 12.0017C149.722 10.0625 146.712 8.17042 143.177 7.6609C131.964 5.10358 121.769 5.41595 111.386 10.739C102.606 14.0416 95.6736 17.969 90.1394 25.8015C91.3806 30.1193 86.9417 31.5918 84.8591 29.5066C83.925 29.3849 82.9048 28.594 82.1208 26.9841C78.5791 22.6341 74.3632 18.9105 69.8981 15.5349C62.9529 10.4323 54.7086 7.52768 46.4177 5.44801Z"
          fill="black"
        />
      </g>
      <defs>
        <filter
          id="filter0_d_3744_1316"
          x="0"
          y="0"
          width="176"
          height="164"
          filterUnits="userSpaceOnUse"
          color-interpolation-filters="sRGB"
        >
          <feFlood flood-opacity="0" result="BackgroundImageFix" />
          <feColorMatrix
            in="SourceAlpha"
            type="matrix"
            values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"
            result="hardAlpha"
          />
          <feOffset dy="6" />
          <feGaussianBlur stdDeviation="2" />
          <feComposite in2="hardAlpha" operator="out" />
          <feColorMatrix
            type="matrix"
            values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.25 0"
          />
          <feBlend
            mode="normal"
            in2="BackgroundImageFix"
            result="effect1_dropShadow_3744_1316"
          />
          <feBlend
            mode="normal"
            in="SourceGraphic"
            in2="effect1_dropShadow_3744_1316"
            result="shape"
          />
        </filter>
      </defs>
    </svg>
  );

  return (
    <div
      ref={setNodeRef}
      style={style}
      {...listeners}
      {...attributes}
      className={`w-1/7 aspect-square absolute z-10 scale-90  
        ${dropped ? droppedStyle : initialStyle}
         ${isDragging ? "transition-none scale-105 cursor-grabbing" : "transition-transform"} `}
    >
      {/* image of dumpling */}
      <img
        src={dumplingImage}
        className="w-full absolute z-30 pointer-events-none"
      />
      {/* svg for border glow/shadow */}
      {/* <svg
        className={`w-full h-auto absolute scale-105 z-10 
          ${isDragging ? "animate-none" : "animate-pulse-fast"}
          ${dropped ? "invisible" : ""} `}
        width="205"
        height="190"
        viewBox="0 0 205 190"
        fill="black"
        fillOpacity="0.15"
        xmlns="http://www.w3.org/2000/svg"
      >
        <g filter="url(#filter0_f_1985_1286)">
          <path
            d="M86.9437 172.594L86.9452 172.596L86.9453 172.596L90.5739 177.417L95.3743 173.761L91.739 168.988C95.3743 173.761 95.375 173.761 95.376 173.76L95.3793 173.757L95.3911 173.749L95.4346 173.715L95.6006 173.588C95.7459 173.477 95.9596 173.313 96.2376 173.099C96.7937 172.67 97.6074 172.04 98.6463 171.229C100.724 169.607 103.703 167.258 107.323 164.341C114.56 158.51 124.379 150.393 134.69 141.26C144.99 132.138 155.847 121.943 165.132 111.959C174.319 102.081 182.347 92.0111 186.588 83.161C192.378 71.0804 195.707 57.4976 193.705 44.9366C191.642 31.9988 183.988 20.7354 169.193 13.9433C152.313 6.19436 133.291 13.8567 120.039 21.6652C113.154 25.7218 107.224 30.1733 103.029 33.5931C102.038 34.4005 101.141 35.1534 100.346 35.8337C99.6268 35.2294 98.8244 34.5691 97.9468 33.8671C93.9207 30.6464 88.235 26.4836 81.678 22.8155C69.136 15.7992 50.7867 9.1657 35.2926 19.0689C21.1711 28.0947 14.3585 41.9031 11.8841 54.9092C9.44489 67.7304 11.0733 80.5012 14.6879 88.3588C15.828 90.8373 18.1386 93.8008 20.6076 96.7063C23.2249 99.7863 26.561 103.411 30.2588 107.345C32.3249 109.544 34.5095 111.845 36.7686 114.225C42.6754 120.448 49.0913 127.207 55.2292 134.063C63.734 143.563 71.6686 153.202 77.4859 160.48C80.3917 164.114 82.7627 167.152 84.4048 169.277C85.2257 170.34 85.8641 171.174 86.2957 171.74C86.5115 172.023 86.6755 172.24 86.7848 172.384L86.9072 172.546L86.9369 172.585L86.9437 172.594Z"
            stroke="#FFEC5B"
            stroke-opacity="0.9"
            stroke-width={isDragging ? "0" : "20"} //disable glow while dragging
          />
        </g> */}
      {/* disable glow while dragging */}
      {/* {!isDragging ? glowSVG : shadowSVG}
      </svg> */}
      {!isDragging ? glowSVG : shadowSVG}
    </div>
  );
};

export default DumplingHeart;
